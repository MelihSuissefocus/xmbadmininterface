# XMB Group Admin Portal - Project Specification

## 1. Overview
Admin portal for XMB Group (IT Recruitment). Manage internal vacancies (Contracting/Permanent) and candidate profiles.
URLs:
- Public Site: `xmb-group.ch`
- Admin Portal: `admin.xmb-group.ch`

## 2. Authentication & Security
**Library:** Auth.js v5
**Provider:** Credentials Provider (Email/Password) for internal staff.
**Requirements:**
- Login Page at `/login`.
- Protect all routes under `/dashboard`.
- Database Table `users`: id, email, password_hash, role (admin).
- Middleware: Redirect unauthenticated users to login.

## 3. Database Schema (Drizzle/Neon)

### Table: `users`
- id (uuid, pk)
- email (varchar, unique)
- password (text)
- created_at

### Table: `jobs`
- id (uuid, pk)
- title (text)
- type (enum: 'contract', 'permanent')
- description (text) - stores HTML or Markdown
- workload (text) - e.g. "80-100%"
- location (text)
- status (enum: 'draft', 'published', 'archived')
- published_at (timestamp)
- created_at

### Table: `candidates`
- id (uuid, pk)
- name (text)
- email (text)
- original_cv_url (text) - Vercel Blob URL
- branded_cv_url (text) - Generated PDF URL
- parsed_data (jsonb) - AI extracted data (skills, experience list)
- status (enum: 'new', 'reviewed', 'rejected', 'placed')
- created_at

## 4. Feature: Job Management
- **CRUD Operations:** Create, Read, Update, Delete jobs.
- **Publishing:** When status is set to `published`:
  - Ensure data is committed to Neon.
  - Optional: Trigger a webhook to `xmb-group.ch` to revalidate Static Site Generation (ISR).

## 5. Feature: CV Parsing Engine & Branding
This is the core automation feature.

**Workflow:**
1. **Upload:** User uploads a PDF via a Dropzone.
   - Action: Upload file to **Vercel Blob**.
   - Result: Get a public URL.
2. **AI Extraction:**
   - Action: Send PDF text/URL to OpenAI GPT-4o.
   - Prompt Goal: "Extract candidate Name, Email, Skills (list), Experience (Array of {Role, Company, Date, Description}), Education."
   - Result: Store JSON in `candidates.parsed_data`.
3. **Review Interface:**
   - UI: Show a split screen. Original PDF on the left, Editable Form (pre-filled with JSON data) on the right.
   - User corrects AI errors and clicks "Save & Generate".
4. **Branding Generation:**
   - Action: Use `@react-pdf/renderer` to generate a new PDF.
   - Design: Header with XMB Logo, standardized font, clean layout (removing original candidate formatting).
   - Result: Upload generated PDF to Vercel Blob and save URL to `candidates.branded_cv_url`.

## 6. UI/UX
- **Theme:** Professional, Clean, XMB Corporate Colors (Blue/Dark).
- **Layout:**
  - Sidebar: Dashboard, Jobs, Candidates, Settings, Logout.
  - Header: Breadcrumbs, User Profile.